---
title: "Data Translation Project"
author: "Andrew Nalundasan"
date: "August 27, 2021"   
output: 
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo = FALSE}
# Course: OMSBA 5210, Seattle University
# Purpose: DTC Technical Appendix
# Date: August 27th, 2021
# Author: Andrew Nalundasan

```

# Load Libraries

```{r message=FALSE, include=FALSE}
library(tidyverse)     # contains ggplot2, dplyr, and several other packages
library(ggannotate)    # annotation tool
library(gridExtra)     # use to put graphs together in the same frame
library(janitor)       # contains tidyverse functions for cross-tables
library(knitr)         # contains some table formatting functions
library(GGally)        # contains a custom correlation plot
library(scales)        # to get $ and , on axis in graph
library(corrplot)      # used for correlation plot with good looks below
library(tidyr)         # tidy r
library(kableExtra)    # extra kable formatting
library(vtable)        # NHK special
library(gghighlight)   # visual formatting - highlights
library(agricolae)     # for statistical testing
library(huxtable)      # table formatting
library(jtools)        # export summs table
library(car)           # linear hypothesis

```



# Load and Transform Data

1. Make updates to data

2. Wrangle 6 subsets of data to answer the 6 different research questions

    1. Determine the primary factors that impact attendance intentions, media consumption intentions, and merchandise consumption intention. 
    2. Determine the factors that impact satisfaction (Performance, Outcome, Matchday Satisfaction).
    3. Determine ways to increase brand attitude.
    4. Investigate purchasing habits of corporate partner products. 
    5. Investigate ways to improve gameday experience. 
    6. Identify viable market segments

```{r include=FALSE}
# read data into environment and assign to object
soccer_og <- read_csv("../02_raw_data/Seattle_Reign.csv")

# transform Interest responses to numeric
soccer_updates <- soccer_og %>% 
  mutate(Interest = str_replace_all(Interest, "I have a small amount of interest", "1")) %>% 
  mutate(Interest = str_replace_all(Interest, "I consider myself to be a low-level fan of this team", "2")) %>% 
  mutate(Interest = str_replace_all(Interest, "I consider myself to be a moderate fan of this team", "3")) %>% 
  mutate(Interest = str_replace_all(Interest, "I consider myself to be a loyal fan of this team", "4")) %>% 
  mutate(Interest = str_replace_all(Interest, "I live and die with this team", "5")) %>% 
  mutate(Interest = as.factor(Interest)) %>% 
  # rename media variables
  rename(Website = Media8_1, Facebook = Media8_2, Twitter = Media8_3, Instagram = Media8_4, YouTube = Media8_5) %>% 
  # rename game_with variables
  rename(gamewit_fam = Gamewit1, gamewit_friends = Gamewit2, gamewit_colleagues = Gamewit3, gamewit_solo = Gamewit4)


```

```{r}
# Question 1 - Determine the primary factors that impact attendance intentions, media consumption intentions, and merchandise consumption intention. 

# select variables that will answer research question 1
q1 <- soccer_og %>% 
  select(Cost3, Clink1, Starfir1, Attend17, Seat1, Ticket1,
         Media8_1:Media8_5, Media9, Media10, Media1:Media6, Media12, Media7a, Media7b,
         Buymer1, Buyonl1, BuyMat1, BuyStor1, BuySpon1, Merimp20, Merimp22, Merimp24)
  
# select and mutate variables that answer Media Consumption Intentions
media_int <- q1 %>% 
  select(Media8_1:Media7b) %>% 
  mutate(Media1 = str_sub(Media1, -2)) %>% 
  mutate(Media3 = str_sub(Media3, -2)) %>%
  mutate(Media4 = str_sub(Media4, -2)) %>%
  mutate(Media5 = str_sub(Media5, -2)) %>%
  mutate(Media6 = str_sub(Media6, -2)) %>%
  mutate(Media12 = str_sub(Media12, -2)) %>%
  mutate(Media7a = str_sub(Media7a, -2)) %>%
  mutate(Media7b = str_sub(Media7b, -2)) %>% 
  rename(Website = Media8_1, Facebook = Media8_2, Twitter = Media8_3, Instagram = Media8_4, YouTube = Media8_5) %>% 
  mutate(across(starts_with("Media"), function(x) as.numeric(x))) %>%
  pivot_longer(cols = everything()) %>% 
  group_by(name) %>% 
  summarise(value = mean(value, na.rm = TRUE))

# select and mutate variables that answer Merchandise Consumption Intentions
merch_int <- q1 %>% 
  select(Buymer1:Merimp24)


# select and mutate variables that answer Attendance Intentions
att_int <- q1 %>% 
  select(c(1:6))

```


```{r}
# Question 2 - Determine the factors that impact satisfaction (Performance, Outcome, Matchday Satisfaction).

# select variables that will answer research question 2
q2 <- soccer_og %>% 
  select(Skill2, Success2, Drama4, Aggress3, Satperf3,
         Interest, IDnattm1, IDcomm2, Escape1, Skill2, Success2, Drama4, Aggress3, Socint1, RoleMod2, Satout2, Satperf3,
         Cost3, Promo3:Promo6, Travel1:Travel3, Travel5, Travel6, Seat1)


# select and mutate variables that will answer Performance Satisfaction
perf_sat <- q2 %>% 
  select(c(1:5))


# select and mutate variables that will answer Outcome Satisfaction
out_sat <- q2 %>% 
  select(Interest:Satout2, Skill2:Satperf3, )


# select and mutate variables that will answer Matchday Satisfaction
match_sat <- q2 %>% 
  select(Interest, Cost3, Promo3:Promo6, Travel1:Travel3, Travel5, Travel6, Seat1) %>% 
  mutate(across(starts_with('Promo'), function(x) str_sub(x, -1))) %>% 
  mutate() # mutate travel responses for Trave1-Travel3 but not Travel5-Travel6
  


```



```{r}
# Question 3 - Determine ways to increase brand attitude.


```



```{r}
# Question 4 - Investigate purchasing habits of corporate partner products. 

soccer_sponsors <- soccer_og %>% 
  # select businesses that sponsor the Reign
  select(Spnbuy1:Spnbuy10) %>% 
  # take the last character of each response to get numeric ranking
  mutate(across(starts_with('Spnbuy'), function(x) str_sub(x, -1))) %>% 
  # rename variables to real businesses
  rename(Subaru = Spnbuy1, 
         Microsoft = Spnbuy2, 
         Pepsi = Spnbuy3, 
         BECU = Spnbuy4, 
         Chihuly = Spnbuy5, 
         Hardrock = Spnbuy6, 
         Health_Warrior = Spnbuy7, 
         Hyatt = Spnbuy8, 
         Kraken_Congee = Spnbuy9, 
         Ruffneck_Scarves = Spnbuy10) %>% 
  # make each column a row
  pivot_longer(cols = everything())%>% 
  # change class of 'value' to numeric
  mutate(value = as.numeric(value)) %>% 
  # group by and summarise the data
  group_by(name) %>% 
  summarise(value = mean(value, na.rm = TRUE))
  
         

```



```{r}
# Question 5 - Investigate ways to improve gameday experience.


```





```{r}
# Question 6 - Identify viable market segments



```








